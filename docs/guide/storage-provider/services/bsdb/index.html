<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guide/storage-provider/services/bsdb">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">BSDB | BNB Optimistic Rollup</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/opbnb-docs/docs/guide/storage-provider/services/bsdb"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="BSDB | BNB Optimistic Rollup"><meta data-rh="true" name="description" content="BS (Block Syncer Database) store needs to implement BSDB interface. SQL database is used by default."><meta data-rh="true" property="og:description" content="BS (Block Syncer Database) store needs to implement BSDB interface. SQL database is used by default."><link data-rh="true" rel="icon" href="/opbnb-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/opbnb-docs/docs/guide/storage-provider/services/bsdb"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/opbnb-docs/docs/guide/storage-provider/services/bsdb" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/opbnb-docs/docs/guide/storage-provider/services/bsdb" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/opbnb-docs/blog/rss.xml" title="BNB Optimistic Rollup RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/opbnb-docs/blog/atom.xml" title="BNB Optimistic Rollup Atom Feed"><link rel="stylesheet" href="/opbnb-docs/assets/css/styles.cbba8081.css">
<link rel="preload" href="/opbnb-docs/assets/js/runtime~main.caf89853.js" as="script">
<link rel="preload" href="/opbnb-docs/assets/js/main.29781c01.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/opbnb-docs/"><div class="navbar__logo"><img src="/opbnb-docs/img/logo.svg" alt="BNB Optimistic Rollup" class="themedImage_ToTc themedImage--light_HNdA"><img src="/opbnb-docs/img/logo.svg" alt="BNB Optimistic Rollup" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">BNB Optimistic Rollup</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_BDYx"><div class="docItemContainer_oq1c"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><div class="row"><div class="col col--12"><h1>BS DB(Block Syncer Database)</h1><p>BS (Block Syncer Database) store needs to implement BSDB interface. SQL database is used by default.
The following mainly introduces the data schemas corresponding to several core interfaces.</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// BSDB contains all the methods required by block syncer database</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> BSDB </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Metadata</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="block-syncer">Block Syncer<a class="hash-link" href="#block-syncer" title="Direct link to heading">​</a></h2><p>Block Syncer retrieves the historical data on the chain, optimizes the storage, and re-structures it according to the different event data types.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="object-table">Object Table<a class="hash-link" href="#object-table" title="Direct link to heading">​</a></h3><p>An object represents a fundamental unit of storage in Greenfield, BSDB object table consists of only associated metadata synced from chain side.</p><p>Below is the schema of <code>Object</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Object is the structure for user object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Object </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ID defines db auto_increment id of object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID </span><span class="token builtin">uint64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;id&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Creator defines the account address of object creator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Creator common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Address </span><span class="token string" style="color:#e3116c">`gorm:&quot;creator_address&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Owner defines the account address of object owner</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Owner common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Address </span><span class="token string" style="color:#e3116c">`gorm:&quot;column:owner_address&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// BucketName is the name of the bucket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BucketName </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;bucket_name&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ObjectName is the name of object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectName </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;object_name&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ObjectID is the unique identifier of object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectID common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Hash </span><span class="token string" style="color:#e3116c">`gorm:&quot;object_id&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// BucketID is the unique identifier of bucket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BucketID common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Hash </span><span class="token string" style="color:#e3116c">`gorm:&quot;bucket_id&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// PayloadSize is the total size of the object payload</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PayloadSize </span><span class="token builtin">uint64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;payload_size&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Visibility defines the highest permissions for bucket. When a bucket is public, everyone can get storage obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Visibility </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;visibility&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ContentType defines the format of the object which should be a standard MIME type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ContentType </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;content_type&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// CreateAt defines the block number when the object created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CreateAt </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;create_at&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// CreateTime defines the timestamp when the object created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CreateTime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;create_time&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ObjectStatus defines the upload status of the object.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ObjectStatus </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;column:status&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// RedundancyType defines the type of the redundancy which can be multi-replication or EC</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    RedundancyType </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;redundancy_type&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SourceType defines the source of the object.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SourceType </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;source_type&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// CheckSums defines the root hash of the pieces which stored in an SP</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Checksums pq</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ByteaArray </span><span class="token string" style="color:#e3116c">`gorm:&quot;check_sums;type:text&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SecondarySpAddresses defines the addresses of secondary_sps</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SecondarySpAddresses pq</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">StringArray </span><span class="token string" style="color:#e3116c">`gorm:&quot;secondary_sp_addresses;type:text&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// LockedBalance defines locked balance of object</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LockedBalance common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Hash </span><span class="token string" style="color:#e3116c">`gorm:&quot;locked_balance&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Removed defines the object is deleted or not</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Removed </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;removed&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// UpdateTime defines the time when the object updated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UpdateTime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;update_time&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// UpdateAt defines the block number when the object updated</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UpdateAt </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;update_at&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Below is the enum of <code>Visibility, RedundancyType, ObjectStatus and SourceType</code>:</p><div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// VisibilityType is the resources public status.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum VisibilityType {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VISIBILITY_TYPE_UNSPECIFIED = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VISIBILITY_TYPE_PUBLIC_READ = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VISIBILITY_TYPE_PRIVATE = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // If the bucket Visibility is inherit, it&#x27;s finally set to private. If the object Visibility is inherit, it&#x27;s the same as bucket.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VISIBILITY_TYPE_INHERIT = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// RedundancyType represents the redundancy algorithm type for object data,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// which can be either multi-replica or erasure coding.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum RedundancyType {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  REDUNDANCY_EC_TYPE = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  REDUNDANCY_REPLICA_TYPE = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// ObjectStatus represents the creation status of an object. After a user successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// sends a CreateObject transaction onto the chain, the status is set to &#x27;Created&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// After the Primary Service Provider successfully sends a Seal Object transaction onto</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// the chain, the status is set to &#x27;Sealed&#x27;.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum ObjectStatus {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  OBJECT_STATUS_CREATED = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  OBJECT_STATUS_SEALED = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// SourceType represents the source of resource creation, which can</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// from Greenfield native or from a cross-chain transfer from BSC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum SourceType {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SOURCE_TYPE_ORIGIN = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SOURCE_TYPE_BSC_CROSS_CHAIN = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SOURCE_TYPE_MIRROR_PENDING = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="bucket-table">Bucket Table<a class="hash-link" href="#bucket-table" title="Direct link to heading">​</a></h3><p>A bucket serves as a logical container for storing objects in Greenfield.
The Bucket table describes the db structure of bucket, and it provides additional storage information compared to the schema on the chain side. e.g. Removed defines the bucket is deleted or not</p><p>Below is the schema of <code>Bucket</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Bucket is the structure for user bucket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Bucket </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ID defines db auto_increment id of bucket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID </span><span class="token builtin">uint64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;id&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Owner is the account address of bucket creator, it is also the bucket owner.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Owner common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Address </span><span class="token string" style="color:#e3116c">`gorm:&quot;column:owner_address&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// BucketName is a globally unique name of bucket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BucketName </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;bucket_name&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Visibility defines the highest permissions for bucket. When a bucket is public, everyone can get storage obj</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Visibility </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;visibility&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ID is the unique identification for bucket.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BucketID common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Hash </span><span class="token string" style="color:#e3116c">`gorm:&quot;bucket_id&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SourceType defines which chain the user should send the bucket management transactions to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SourceType </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;source_type&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// CreateAt defines the block number when the bucket created.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CreateAt </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;create_at&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// CreateTime defines the timestamp when the bucket created</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CreateTime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;create_time&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// PaymentAddress is the address of the payment account</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PaymentAddress common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Address </span><span class="token string" style="color:#e3116c">`gorm:&quot;payment_address&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// PrimarySpAddress is the address of the primary sp. Objects belong to this bucket will never</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// leave this SP, unless you explicitly shift them to another SP.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PrimarySpAddress common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Address </span><span class="token string" style="color:#e3116c">`gorm:&quot;primary_sp_address&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ReadQuota defines the traffic quota for read</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ChargedReadQuota </span><span class="token builtin">uint64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;charged_read_quota&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// PaymentPriceTime defines price time of payment</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PaymentPriceTime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;payment_price_time&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Removed defines the bucket is deleted or not</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Removed </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;removed&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>the enum of <code>Visibility and SourceType</code> are the same as above</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="epoch-table">Epoch Table<a class="hash-link" href="#epoch-table" title="Direct link to heading">​</a></h3><p>The Epoch table describes the latest progress of block event information.</p><p>Below is the schema of <code>Epoch</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Epoch stores current information of the latest block</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> Epoch </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// OneRowID defines if the table only has one row</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OneRowID </span><span class="token builtin">bool</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;one_row_id;not null;default:true;primaryKey&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// BlockHeight defines the latest block number</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BlockHeight </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;block_height;type:bigint(64)&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// BlockHash defines the latest block hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BlockHash common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Hash </span><span class="token string" style="color:#e3116c">`gorm:&quot;block_hash;type:BINARY(32)&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// UpdateTime defines the update time of the latest block</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UpdateTime </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;update_time;type:bigint(64)&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="streamrecord-table">StreamRecord Table<a class="hash-link" href="#streamrecord-table" title="Direct link to heading">​</a></h3><p>The StreamRecord table describes the stream payment record of a stream account.</p><p>Below is the schema of <code>StreamRecord</code>:</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">type</span><span class="token plain"> StreamRecord </span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// ID defines db auto_increment id of stream record</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID </span><span class="token builtin">uint64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;id&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Account defines the account address</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Account common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Address </span><span class="token string" style="color:#e3116c">`gorm:&quot;account&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// CrudTimestamp defines the latest update timestamp of the stream record</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    CrudTimestamp </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;crud_timestamp&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// NetflowRate defines the per-second rate that an account&#x27;s balance is changing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// It is the sum of the account&#x27;s inbound and outbound flow rates.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NetflowRate </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Big </span><span class="token string" style="color:#e3116c">`gorm:&quot;netflow_rate&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// StaticBalance defines the balance of the stream account at the latest CRUD timestamp.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    StaticBalance </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Big </span><span class="token string" style="color:#e3116c">`gorm:&quot;static_balance&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// BufferBalance defines reserved balance of the stream account</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// If the netflow rate is negative, the reserved balance is `netflow_rate * reserve_time`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BufferBalance </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Big </span><span class="token string" style="color:#e3116c">`gorm:&quot;buffer_balance&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// LockBalance defines the locked balance of the stream account after it puts a new object and before the object is sealed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    LockBalance </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">common</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Big </span><span class="token string" style="color:#e3116c">`gorm:&quot;lock_balance&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Status defines the status of the stream account</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Status </span><span class="token builtin">string</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;status&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// SettleTimestamp defines the unix timestamp when the stream account will be settled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SettleTimestamp </span><span class="token builtin">int64</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;column:settle_timestamp&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// OutFlows defines the accumulated outflow rates of the stream account</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    OutFlows </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token builtin">byte</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">`gorm:&quot;out_flows;type:longblob&quot;`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div><div class="col col--12"><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/bnb-chain/opbnb-docs/docs/guide/storage-provider/services/bsdb.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></div></article><div class="col col--12"><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#block-syncer" class="table-of-contents__link toc-highlight">Block Syncer</a><ul><li><a href="#object-table" class="table-of-contents__link toc-highlight">Object Table</a></li><li><a href="#bucket-table" class="table-of-contents__link toc-highlight">Bucket Table</a></li><li><a href="#epoch-table" class="table-of-contents__link toc-highlight">Epoch Table</a></li><li><a href="#streamrecord-table" class="table-of-contents__link toc-highlight">StreamRecord Table</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"></div></footer></div>
<script src="/opbnb-docs/assets/js/runtime~main.caf89853.js"></script>
<script src="/opbnb-docs/assets/js/main.29781c01.js"></script>
</body>
</html>